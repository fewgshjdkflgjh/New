<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Train Tracker â€” Thick Tracks</title>
<style>
  body {
    background: #cfe6ff;
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  h1 {
    margin: 10px 0;
    font-size: 28px;
  }
  #map {
    position: relative;
    width: 1500px;
    height: 1000px;
    background: #b3d1ff;
    margin: 0 auto;
    overflow: hidden;
    border: 3px solid #222;
  }
  canvas {
    width: 100%;
    height: 100%;
  }
</style>
</head>
<body>
<h1>ðŸš„ Train Tracker â€” Thick Tracks View</h1>
<canvas id="map" width="1500" height="1000"></canvas>

<script>
const canvas = document.getElementById('map');
const ctx = canvas.getContext('2d');

// Larger map scale and offsets
const scale = 0.5;
const offsetX = canvas.width / 2;
const offsetY = canvas.height / 2;

let tracks = [];
let trainPos = null;

// Draw a smooth rail with thick double lines
function drawSmoothTrack(ctx, points) {
  if (points.length < 2) return;

  // Draw the outer track lines (left/right rail)
  ctx.lineWidth = 8;
  ctx.strokeStyle = '#222';
  ctx.beginPath();
  ctx.moveTo(points[0].x, points[0].y);

  for (let i = 0; i < points.length - 1; i++) {
    const c = points[i];
    const n = points[i + 1];
    const cx = (c.x + n.x) / 2;
    const cy = (c.y + n.y) / 2;
    ctx.quadraticCurveTo(c.x, c.y, cx, cy);
  }
  ctx.lineTo(points[points.length - 1].x, points[points.length - 1].y);
  ctx.stroke();

  // Add faint gray inner shading for detail
  ctx.strokeStyle = '#666';
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.moveTo(points[0].x, points[0].y);
  for (let i = 0; i < points.length - 1; i++) {
    const c = points[i];
    const n = points[i + 1];
    const cx = (c.x + n.x) / 2;
    const cy = (c.y + n.y) / 2;
    ctx.quadraticCurveTo(c.x, c.y, cx, cy);
  }
  ctx.lineTo(points[points.length - 1].x, points[points.length - 1].y);
  ctx.stroke();
}

// Redraw map + train
function drawMap() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const mapped = tracks.map(p => ({
    x: p.x * scale + offsetX,
    y: -p.z * scale + offsetY
  }));

  // Draw the thick smooth track
  drawSmoothTrack(ctx, mapped);

  // Draw train
  if (trainPos) {
    const x = trainPos.x * scale + offsetX;
    const y = -trainPos.z * scale + offsetY;
    ctx.fillStyle = '#ffcc00';
    ctx.beginPath();
    ctx.arc(x, y, 18, 0, Math.PI * 2);
    ctx.fill();
    ctx.strokeStyle = '#000';
    ctx.lineWidth = 3;
    ctx.stroke();
  }
}

// Load track data
fetch('tracks.json')
  .then(res => res.json())
  .then(data => {
    tracks = data;
    drawMap();
  });

// Update train every 100 ms
setInterval(() => {
  fetch('train.json')
    .then(res => res.json())
    .then(data => {
      trainPos = data;
      drawMap();
    })
    .catch(() => {});
}, 100);
</script>
</body>
</html>